<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HKDSE 成績分析器</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --success: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #34495e;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: "Microsoft JhengHei", "微軟正黑體", sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px 0;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-around;
            background-color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--secondary);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--dark);
        }
        
        .card {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .card-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--primary);
            border-bottom: 2px solid var(--light);
            padding-bottom: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        select, input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .btn {
            background-color: var(--secondary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        
        .btn:hover {
            background-color: #2980b9;
        }
        
        .btn-reset {
            background-color: var(--warning);
            margin-left: 10px;
        }
        
        .btn-reset:hover {
            background-color: #e67e22;
        }
        
        .results-section {
            display: none;
        }
        
        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .result-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .result-value {
            font-size: 2rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .result-label {
            font-size: 1rem;
            color: var(--dark);
        }
        
        .success {
            color: var(--success);
        }
        
        .danger {
            color: var(--danger);
        }
        
        .subject-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .subject-item {
            background-color: var(--light);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .subject-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .subject-score {
            font-size: 1.2rem;
            color: var(--secondary);
        }
        
        .suggestion-list {
            list-style-type: none;
        }
        
        .suggestion-list li {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .suggestion-list li:last-child {
            border-bottom: none;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }
        
        .tab.active {
            border-bottom: 3px solid var(--secondary);
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .result-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-bar {
                flex-direction: column;
                gap: 15px;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>📊 HKDSE 成績分析器</h1>
            <p class="subtitle">個人化升學分析平台</p>
            <p>基於2024官方數據，提供即時百分位排名、332A檢查及個人化建議</p>
        </header>
        
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value">49,026</div>
                <div class="stat-label">名考生</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">📈</div>
                <div class="stat-label">即時排名</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">20+</div>
                <div class="stat-label">科目選擇</div>
            </div>
        </div>
        
        <div class="card">
            <h2 class="card-title">輸入你的成績</h2>
            
            <div class="tabs">
                <div class="tab active" data-tab="core">核心科目</div>
                <div class="tab" data-tab="elective">選修科目</div>
                <div class="tab" data-tab="math-extended">數學延伸部分</div>
            </div>
            
            <form id="grade-form">
                <div class="tab-content active" id="core-tab">
                    <div class="form-group">
                        <h3>核心科目（必填）</h3>
                        <div class="subject-list">
                            <div class="subject-item">
                                <div class="subject-name">中國語文</div>
                                <select id="chinese" required>
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">英國語文</div>
                                <select id="english" required>
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">數學必修部分</div>
                                <select id="math" required>
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">公民與社會發展</div>
                                <select id="citizenship" required>
                                    <option value="">選擇等級</option>
                                    <option value="達標">✅ 達標</option>
                                    <option value="未達標">❌ 未達標</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="elective-tab">
                    <div class="form-group">
                        <h3>選修科目（選填）</h3>
                        <div class="subject-list">
                            <div class="subject-item">
                                <div class="subject-name">中國文學</div>
                                <select id="chinese-literature">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">生物</div>
                                <select id="biology">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">企業、會計與財務概論</div>
                                <select id="business">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">英語文學</div>
                                <select id="english-literature">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">化學</div>
                                <select id="chemistry">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">設計與應用科技</div>
                                <select id="design-tech">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">中國歷史</div>
                                <select id="chinese-history">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">物理</div>
                                <select id="physics">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">健康管理與社會關懷</div>
                                <select id="health-care">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">經濟</div>
                                <select id="economics">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">資訊及通訊科技</div>
                                <select id="ict">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">倫理與宗教</div>
                                <select id="ethics-religion">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">科技與生活</div>
                                <select id="tech-living">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">地理</div>
                                <select id="geography">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">音樂</div>
                                <select id="music">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">歷史</div>
                                <select id="history">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">視覺藝術</div>
                                <select id="visual-arts">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">旅遊與款待</div>
                                <select id="tourism">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">體育</div>
                                <select id="pe">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="math-extended-tab">
                    <div class="form-group">
                        <h3>數學延伸部分（選填）</h3>
                        <div class="subject-list">
                            <div class="subject-item">
                                <div class="subject-name">延伸部分（微積分與統計）</div>
                                <select id="math-calculus">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                            <div class="subject-item">
                                <div class="subject-name">延伸部分（代數與微積分）</div>
                                <select id="math-algebra">
                                    <option value="">選擇等級</option>
                                    <option value="5**">5**</option>
                                    <option value="5*">5*</option>
                                    <option value="5">5</option>
                                    <option value="4">4</option>
                                    <option value="3">3</option>
                                    <option value="2">2</option>
                                    <option value="1">1</option>
                                    <option value="U">U</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <button type="submit" class="btn">分析我的成績</button>
                    <button type="button" class="btn btn-reset" id="reset-btn">重設所有成績</button>
                </div>
            </form>
        </div>
        
        <div class="results-section" id="results-section">
            <div class="card">
                <h2 class="card-title">你的成績分析</h2>
                
                <div class="result-grid">
                    <div class="result-card">
                        <div class="result-label">公民與社會發展</div>
                        <div class="result-value" id="citizenship-result">-</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">最佳5科積點</div>
                        <div class="result-value" id="best5-score">-</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">332A要求</div>
                        <div class="result-value" id="requirement-result">-</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">全港排名</div>
                        <div class="result-value" id="ranking">-</div>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">入學機會</h3>
                    <div id="admission-chance">-</div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">個人化建議</h3>
                    <ul class="suggestion-list" id="suggestions">
                        <!-- 建議將通過JavaScript動態生成 -->
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 標籤切換功能
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // 移除所有標籤和內容的active類
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // 添加active類到當前標籤和對應內容
                tab.classList.add('active');
                const tabId = tab.getAttribute('data-tab') + '-tab';
                document.getElementById(tabId).classList.add('active');
            });
        });
        
        // 重設按鈕功能
        document.getElementById('reset-btn').addEventListener('click', function() {
            if (confirm('確定要重設所有成績嗎？')) {
                document.getElementById('grade-form').reset();
                document.getElementById('results-section').style.display = 'none';
            }
        });
        
        // 表單提交處理
        document.getElementById('grade-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // 獲取所有科目成績
            const subjects = {
                // 核心科目
                'chinese': document.getElementById('chinese').value,
                'english': document.getElementById('english').value,
                'math': document.getElementById('math').value,
                'citizenship': document.getElementById('citizenship').value,
                
                // 選修科目
                'chinese-literature': document.getElementById('chinese-literature').value,
                'biology': document.getElementById('biology').value,
                'business': document.getElementById('business').value,
                'english-literature': document.getElementById('english-literature').value,
                'chemistry': document.getElementById('chemistry').value,
                'design-tech': document.getElementById('design-tech').value,
                'chinese-history': document.getElementById('chinese-history').value,
                'physics': document.getElementById('physics').value,
                'health-care': document.getElementById('health-care').value,
                'economics': document.getElementById('economics').value,
                'ict': document.getElementById('ict').value,
                'ethics-religion': document.getElementById('ethics-religion').value,
                'tech-living': document.getElementById('tech-living').value,
                'geography': document.getElementById('geography').value,
                'music': document.getElementById('music').value,
                'history': document.getElementById('history').value,
                'visual-arts': document.getElementById('visual-arts').value,
                'tourism': document.getElementById('tourism').value,
                'pe': document.getElementById('pe').value,
                
                // 數學延伸部分
                'math-calculus': document.getElementById('math-calculus').value,
                'math-algebra': document.getElementById('math-algebra').value
            };
            
            // 計算結果
            const citizenshipResult = subjects.citizenship === '達標' ? 
                '<span class="success">✅ 達標</span>' : 
                '<span class="danger">❌ 未達標</span>';
            
            // 計算所有有效科目的積點
            const scores = [];
            for (const [subject, grade] of Object.entries(subjects)) {
                if (grade && grade !== 'U' && grade !== '未達標') {
                    scores.push(gradeToPoint(grade));
                }
            }
            
            // 排序並取前5名
            scores.sort((a, b) => b - a);
            const best5 = scores.slice(0, 5);
            const best5Score = best5.reduce((sum, score) => sum + score, 0);
            
            // 檢查332A要求
            const chinesePass = subjects.chinese && ['3', '4', '5', '5*', '5**'].includes(subjects.chinese);
            const englishPass = subjects.english && ['3', '4', '5', '5*', '5**'].includes(subjects.english);
            const mathPass = subjects.math && ['2', '3', '4', '5', '5*', '5**'].includes(subjects.math);
            const citizenshipPass = subjects.citizenship === '達標';
            
            const requirementMet = chinesePass && englishPass && mathPass && citizenshipPass;
            const requirementResult = requirementMet ? 
                '<span class="success">✅ 達標</span>' : 
                '<span class="danger">❌ 未達標</span>';
            
            // 計算排名（基於最佳5科）
            const rankingPercent = calculateRanking(best5Score);
            const ranking = `前 ${rankingPercent}%`;
            
            // 評估入學機會
            let admissionChance = '';
            if (best5Score >= 25) {
                admissionChance = '<span class="success">優秀 - 有機會入讀香港大學、中文大學、科技大學的熱門學科</span>';
            } else if (best5Score >= 20) {
                admissionChance = '<span class="success">良好 - 有機會入讀八大院校的學士學位課程</span>';
            } else if (best5Score >= 15) {
                admissionChance = '中等 - 有機會入讀八大院校的學士學位課程或高級文憑課程';
            } else if (best5Score >= 10) {
                admissionChance = '一般 - 建議考慮副學士或高級文憑課程';
            } else {
                admissionChance = '<span class="danger">較低 - 建議考慮基礎文憑或重讀</span>';
            }
            
            // 生成個人化建議
            const suggestions = generateSuggestions(subjects, best5Score, requirementMet);
            
            // 更新結果
            document.getElementById('citizenship-result').innerHTML = citizenshipResult;
            document.getElementById('best5-score').textContent = best5Score;
            document.getElementById('requirement-result').innerHTML = requirementResult;
            document.getElementById('ranking').textContent = ranking;
            document.getElementById('admission-chance').innerHTML = admissionChance;
            
            const suggestionsList = document.getElementById('suggestions');
            suggestionsList.innerHTML = '';
            suggestions.forEach(suggestion => {
                const li = document.createElement('li');
                li.textContent = suggestion;
                suggestionsList.appendChild(li);
            });
            
            // 顯示結果
            document.getElementById('results-section').style.display = 'block';
            
            // 滾動到結果
            document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
        });
        
        function gradeToPoint(grade) {
            switch(grade) {
                case '5**': return 7;
                case '5*': return 6;
                case '5': return 5;
                case '4': return 4;
                case '3': return 3;
                case '2': return 2;
                case '1': return 1;
                default: return 0;
            }
        }
        
        function calculateRanking(score) {
            // 簡化的排名計算（實際應基於PDF數據）
            if (score >= 30) return 5;
            if (score >= 25) return 10;
            if (score >= 20) return 20;
            if (score >= 15) return 40;
            if (score >= 10) return 60;
            return 80;
        }
        
        function generateSuggestions(subjects, best5Score, requirementMet) {
            const suggestions = [];
            
            if (!requirementMet) {
                suggestions.push('⚠️ 你未達到332A基本入學要求，建議重考相關科目');
            }
            
            if (subjects.chinese && ['1', '2', 'U'].includes(subjects.chinese)) {
                suggestions.push('📝 中國語文成績有待提升，建議加強閱讀理解和寫作練習');
            }
            
            if (subjects.english && ['1', '2', 'U'].includes(subjects.english)) {
                suggestions.push('📝 英國語文成績有待提升，建議多練習聆聽和會話');
            }
            
            if (subjects.math && ['1', 'U'].includes(subjects.math)) {
                suggestions.push('📝 數學成績有待提升，建議加強基礎運算和應用題練習');
            }
            
            if (subjects.citizenship === '未達標') {
                suggestions.push('📚 公民與社會發展未達標，建議了解評分標準並加強相關知識');
            }
            
            // 根據選修科目提供建議
            if (subjects.biology && ['5**', '5*', '5'].includes(subjects.biology)) {
                suggestions.push('🔬 生物科成績優異，可考慮醫學、生物科技等相關學科');
            }
            
            if (subjects.chemistry && ['5**', '5*', '5'].includes(subjects.chemistry)) {
                suggestions.push('🧪 化學科成績優異，可考慮藥劑、化學工程等相關學科');
            }
            
            if (subjects.physics && ['5**', '5*', '5'].includes(subjects.physics)) {
                suggestions.push('⚛️ 物理科成績優異，可考慮工程、物理治療等相關學科');
            }
            
            if (subjects.economics && ['5**', '5*', '5'].includes(subjects.economics)) {
                suggestions.push('💹 經濟科成績優異，可考慮商科、金融等相關學科');
            }
            
            if (subjects.ict && ['5**', '5*', '5'].includes(subjects.ict)) {
                suggestions.push('💻 資訊及通訊科技成績優異，可考慮電腦科學、資訊科技等相關學科');
            }
            
            if (best5Score >= 25) {
                suggestions.push('🎯 成績優異，可考慮申請香港大學、中文大學或科技大學的熱門學科');
                suggestions.push('💼 可考慮參加聯招以外的自主招生計劃，增加入學機會');
            } else if (best5Score >= 20) {
                suggestions.push('🎯 成績良好，可考慮申請八大院校的學士學位課程');
                suggestions.push('📊 建議參考各院校的計分方法，選擇最有利的學科組合');
            } else if (best5Score >= 15) {
                suggestions.push('🎯 成績中等，可考慮申請八大院校的學士學位課程或高級文憑課程');
                suggestions.push('🔍 建議了解各院校的彈性收生安排，增加入學機會');
            } else {
                suggestions.push('🎯 建議考慮副學士、高級文憑或基礎文憑課程，作為升學途徑');
                suggestions.push('🔄 可考慮重考部分科目，提升成績和入學機會');
            }
            
            suggestions.push('📅 及早規劃升學路徑，了解各院校的收生要求和申請日期');
            suggestions.push('💡 參加院校資訊日，親身了解課程內容和校園環境');
            
            return suggestions;
        }
    </script>
</body>
</html>